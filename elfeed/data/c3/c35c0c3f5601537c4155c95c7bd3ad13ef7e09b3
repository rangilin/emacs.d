
<p>I used to do crazy stuff to setup my Unix environment. Back when I was
working at Tadpole, I had a Python script that would generate a
.profile with paths that existed. Madness!</p>

<p>At Bouygues Telecom I saw the light. Actually I saw it when I finished
working there, but that's another story <img src="smiley.png" alt="">.</p>

<p>The project I was working on had a regression test suite that was
written entirely in shell. This made me realize that it was
sufficiently powerful to setup my environment. So I started using bash
or ksh to setup binary paths, ls colors, etc...</p>

<p>Later, I started using zsh and now there is no way I am going back to
bash. I think of it as the emacs of shells. It comes with the kitchen
sink.</p>

<p>Anyway to get to the point of this blog, these days to feel at home on
a server I only need two configuration files:</p>

<ul>
<li>.zshrc</li>
<li>.vimrc</li>
</ul>

<p>When I am sharing an account .zshrc is usually OK as everyone else
uses bash. However my .vimrc is problematic as it messes the other
users editing experience. They will notice the colors are not right on
their white background.</p>

<p>This is what I do to keep everyone happy. I renamed .vimrc to
.vimrc-ivan and do the following in .zshrc to load it up:</p>

<pre class="src">
<span style="color: #008b00; background-color: #b9babd;"># </span><span style="color: #008b00; background-color: #b9babd;">setup which vi to use
</span><span style="color: #00688b; background-color: #b9babd;">which</span> vim &gt; /dev/null 2&gt;&amp;1
<span style="color: #8b008b; background-color: #b9babd;">if</span> test $<span style="color: #000000; background-color: #b9babd;">?</span> -eq 0 ; <span style="color: #8b008b; background-color: #b9babd;">then</span>
    <span style="color: #00688b; background-color: #b9babd;">export</span> <span style="color: #000000; background-color: #b9babd;">EDITOR</span>=vim
    <span style="color: #8b008b; background-color: #b9babd;">if</span> test -f ${<span style="color: #000000; background-color: #b9babd;">HOME</span>}/.vimrc-ivan ; <span style="color: #8b008b; background-color: #b9babd;">then</span>
        <span style="color: #00688b; background-color: #b9babd;">alias</span> <span style="color: #000000; background-color: #b9babd;">vi</span>=<span style="color: #8b5a00; background-color: #b9babd;">"vim -u ${HOME}/.vimrc-ivan"</span>
    <span style="color: #8b008b; background-color: #b9babd;">else</span>
        <span style="color: #00688b; background-color: #b9babd;">alias</span> <span style="color: #000000; background-color: #b9babd;">vi</span>=vim
    <span style="color: #8b008b; background-color: #b9babd;">fi</span>
<span style="color: #8b008b; background-color: #b9babd;">else</span>
    <span style="color: #00688b; background-color: #b9babd;">export</span> <span style="color: #000000; background-color: #b9babd;">EDITOR</span>=vi
<span style="color: #8b008b; background-color: #b9babd;">fi</span>
</pre>

<p>In the same vein I want to run zsh on the server when I login. I can't
change the shell of the account, that would also annoy people. I
simply alias ssh in .zshrc:</p>

<pre class="src">
<span style="color: #008b00; background-color: #b9babd;"># </span><span style="color: #008b00; background-color: #b9babd;">change host name in screen
</span><span style="color: #00008b; background-color: #b9babd;">ssh</span> () {
    <span style="color: #8b008b; background-color: #b9babd;">if</span> [[ $<span style="color: #000000; background-color: #b9babd;">1</span> -regex-match  <span style="color: #8b5a00; background-color: #b9babd;">'(redmine.*|jenkins.*)'</span> ]] ; <span style="color: #8b008b; background-color: #b9babd;">then</span>
        <span style="color: #008b00; background-color: #b9babd;"># </span><span style="color: #008b00; background-color: #b9babd;">start zsh on servers that don't belong to me
</span>        /usr/bin/ssh $<span style="color: #000000; background-color: #b9babd;">*</span> -t exec zsh
    <span style="color: #8b008b; background-color: #b9babd;">else</span>
        /usr/bin/ssh $<span style="color: #000000; background-color: #b9babd;">*</span>
    <span style="color: #8b008b; background-color: #b9babd;">fi</span>
    <span style="color: #8b008b; background-color: #b9babd;">if</span> test x${<span style="color: #000000; background-color: #b9babd;">TERM</span>} = xscreen ; <span style="color: #8b008b; background-color: #b9babd;">then</span>
        printf <span style="color: #8b5a00; background-color: #b9babd;">"\033k`hostname -s`\033\\\\"</span>
    <span style="color: #8b008b; background-color: #b9babd;">fi</span>
}
</pre>

<p>Now when I ssh to a server I have the prompt I like and I can edit files
the way I want to. All this without irritating others is a boon. It's
time to hack and be merry!</p>

